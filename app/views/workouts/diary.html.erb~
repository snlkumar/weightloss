<div class="grid_12">
	<% total_burned_calories=total_taken_calories=0 %>
	
	<script type="text/javascript" src="/assets/jquery.js"></script>
	<script type="text/javascript">
		$(function() {
			$( "#wkDt2" ).datepicker();
			$( "#wkDt2" ).datepicker( {minDate: -93, maxDate: "+0D" });
			$( "#wkDt2" ).datepicker("option", "dateFormat",'yy-mm-dd' );
			$("#ui-datepicker-div").wrap('<div style="position:absolute;left:0;top:-3em;"></div>');
		});
	
		function prevDate()
		{
			var today="";
			if(document.getElementById("wkDt2").value=="Today")
			{
				dt=currentDt;
			}
			else
			{
				dt=document.getElementById("wkDt2").value;
			}
			today = new Date(dt);	//document.getElementById("wkDt").value
			var msecPerDay = 24 * 60 * 60 * 1000;
		
			var yesterday = new Date(today.getTime() - msecPerDay);
			day=yesterday.getDate();
			month=yesterday.getMonth()+1;
			if(day<10)
			{
				day="0"+day;
			}
			if(month<10)
			{
				month="0"+month;
			}
			document.getElementById("wkDt2").value=yesterday.getFullYear()+"-"+month+"-"+day;
		}
		function currentDate()
		{
			var today = new Date();
			day=today.getDate();
			month=today.getMonth()+1;

			if(day<10)
			{
				day="0"+day;
			}
			if(month<10)
			{
				month="0"+month;
			}
			<%# 
					if !workouts[0].nil? 
						trained=(workouts[0].trained_on).strftime("%Y-%m-%d")
					else
						trained="Today"
					end
			%>
			var dt="<%#=trained%>";

			document.getElementById("wkDt2").value=dt;
			currentDt=today.getFullYear()+"-"+month+"-"+day;
		}
		function nextDate()
		{
			var today="";
			if(document.getElementById("wkDt2").value=="Today")
			{
				dt=currentDt;
			}
			else
			{
				dt=document.getElementById("wkDt2").value;
			}
			today = new Date(dt);	//document.getElementById("wkDt").value
			var msecPerDay = 24 * 60 * 60 * 1000;
		
			var tomorrow = new Date(today.getTime() + msecPerDay);
			day=tomorrow.getDate();
			month=tomorrow.getMonth()+1;

			if(tomorrow>new Date())
			{
				alert("Date cannot be greater then current date");
				return;
			}
			if(day<10)
			{
				day="0"+day;
			}
			if(month<10)
			{
				month="0"+month;
			}
			document.getElementById("wkDt2").value=tomorrow.getFullYear()+"-"+month+"-"+day;
		}

		window.onload = function () {
			currentDate(); //set current date in add meal date field(wdDt2) 
	}

</script>

<%=form_tag '/workouts/dairy' do %>
<div style="margin:1% 0 0 -3%;background:#fff;height:auto;width:98%;padding-right:1%;margin-bottom:2%;">
   <table width="95%" style="border-spacing:1px;border-collapse:separate;">
			<tr>
				<td><h1 style="margin:1% 0;padding:0;">Your Diary for: </h1></td>
				<td width="40%">
					<span class="button" onclick="prevDate()">&lt;</span>
					<input class="today" type="text" style="margin-top:0;height:27px;margin-left:0;margin-right:0;" value="" id="wkDt2" name="trained_on" />
					<span class="button" onclick="nextDate()">&gt;</span>
				</td>
				<td>
					<input type="submit" class="button" onclick="javascript:if(document.getElementById('wkDt2').value==''){alert('please enter a date (yyyy-mm-dd) format'); document.getElementById('wkDt2').focus(); return false;}" id="workoutsDate" style="height:30px;background-color:#0B2B42;color:#fff;" value=Submit /></td>
			</tr>
		</table>
		<hr/><br>
<%end%>

<!-- for food -->
<table width="100%" style="border-spacing:1px;border-collapse:separate;">
	<tr style="background-color:#09F;color:#fff;font-weight:bold;text-align:center;">
    <th style="background-color:#fff;color:#F60;font-weight:bold;text-align:left;font-size:18px;width:45%;">Meals</th>
    <td width="30%" style="padding-top:5px;">Calories Taken</td>
  </tr>
	<% if @meals
			@meals.each do |m| %>	
  <tr style="background-color:#CEECF5;text-align:center;">
    <td style="text-align:left" width="45%"><%=m.name%></td>
    <td><%=m.calories%></td>
   <!-- <td><%#= link_to image_tag("/assets/delete.png"), "/workouts/#{w.id}",:confirm=>'Are You Sure?', :method=>:Delete %></td> -->
		</tr>
		<% 
			total_taken_calories+=m.calories
		%>
	<%end end%>
</table>
<hr/> 


<!-- for exercise -->
<table width="100%" style="border-spacing:1px;border-collapse:separate;">
	<tr style="background-color:#09F;color:#fff;font-weight:bold;text-align:center;">
    <th style="background-color:#fff;color:#F60;font-weight:bold;text-align:left;font-size:18px;width:45%;">Meals</th>
    <td width="30%" style="padding-top:5px;">Calories Taken</td>
  </tr>
	<% if @workouts
			@workouts.each do |w| %>	
  <tr style="background-color:#CEECF5;text-align:center;">
    <td style="text-align:left" width="45%"><%=w.name%></td>
    <td><%=w.calories%></td>
   <!-- <td><%#= link_to image_tag("/assets/delete.png"), "/workouts/#{w.id}",:confirm=>'Are You Sure?', :method=>:Delete %></td> -->
		</tr>
		<% 
			total_burned_calories+=w.calories
		%>
	<%end end%>
</table>
<hr/>


		
		
		
		<table width="80%" style="border-spacing:1px;border-collapse:separate;margin-left:15%;"> 
			<tr style="font-weight:bold;text-align:center;">
				<td style="text-align:right;width:30%;">Total Remaining Calories<!--/Goal--></td>
				<td style="text-align:right;width:30%;"><%=(total_taken_calories-total_burned_calories)%><!--/Goal--></td>
			</tr>
		<!--	<tr style="font-weight:bold;text-align:center;">
				<td style="text-align:right;width:30%;">Weekly Total</td>
				<td width="25%" style="padding-left:2%;"><%#=weekly_calc[0].weekly_duration.to_i%></td>
				<td width="25%" style="padding-left:7%;"><%#=weekly_calc[0].weekly_cal.to_i%></td> -->
			</tr>
		</table>
	<hr/> 

</div>
</div>
</div>
